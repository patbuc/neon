// neon.13.n - Complex program: recursion, loops, nested functions
// Tests: functions, recursion, loops, conditionals, variables

// Expected:
// === Fibonacci (recursive) ===
// 0
// 1
// 5
// 21
// === Factorial ===
// 1
// 120
// 720
// === Primes ===
// true
// false
// false
// false
// 1
// 1
// === Sum of Squares ===
// 55
// 385
// === Power ===
// 1
// 8
// 81
// === Ackermann (small values) ===
// 1
// 4
// 7
// === Nested loops ===
// 36
// 225

// Fibonacci using recursion
fn fibonacci(n) {
  if (n <= 1) {
    return n
  }
  return fibonacci(n - 1) + fibonacci(n - 2)
}

// Recursive factorial
fn factorial(n) {
  if (n <= 1) {
    return 1
  }
  return n * factorial(n - 1)
}

// Check if number is prime
fn is_prime(n) {
  if (n <= 1) {
    return false
  }
  if (n == 2) {
    return true
  }
  if (n / 2 * 2 == n) {
    return false
  }
  var i = 3
  while (i * i <= n) {
    if (n / i * i == n) {
      return false
    }
    i = i + 2
  }
  return true
}

// Count primes up to n
fn count_primes(limit) {
  var count = 0
  var i = 2
  while (i <= limit) {
    if (is_prime(i)) {
      count = count + 1
    }
    i = i + 1
  }
  return count
}

// Sum of squares up to n
fn sum_of_squares(n) {
  var sum = 0
  var i = 1
  while (i <= n) {
    sum = sum + i * i
    i = i + 1
  }
  return sum
}

// Power function using recursion
fn power(base, exp) {
  if (exp == 0) {
    return 1
  }
  if (exp == 1) {
    return base
  }
  return base * power(base, exp - 1)
}

// Ackermann function - highly recursive
fn ackermann(m, n) {
  if (m == 0) {
    return n + 1
  }
  if (n == 0) {
    return ackermann(m - 1, 1)
  }
  return ackermann(m - 1, ackermann(m, n - 1))
}

// Nested loops: sum of products
fn nested_sum(n) {
  var sum = 0
  var i = 1
  while (i <= n) {
    var j = 1
    while (j <= n) {
      sum = sum + i * j
      j = j + 1
    }
    i = i + 1
  }
  return sum
}

print("=== Fibonacci (recursive) ===")
print(fibonacci(0))
print(fibonacci(1))
print(fibonacci(5))
print(fibonacci(8))

print("=== Factorial ===")
print(factorial(0))
print(factorial(5))
print(factorial(6))

print("=== Primes ===")
print(is_prime(2))
print(is_prime(3))
print(is_prime(4))
print(is_prime(17))
print(count_primes(10))
print(count_primes(20))

print("=== Sum of Squares ===")
print(sum_of_squares(5))
print(sum_of_squares(10))

print("=== Power ===")
print(power(2, 0))
print(power(2, 3))
print(power(3, 4))

print("=== Ackermann (small values) ===")
print(ackermann(0, 0))
print(ackermann(1, 2))
print(ackermann(2, 2))

print("=== Nested loops ===")
print(nested_sum(3))
print(nested_sum(5))
